{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "$id": "https://cleo-dev.com/schemas/v1/research-manifest.schema.json",
  "title": "Agent Output Manifest Entry",
  "description": "Schema for MANIFEST.jsonl entries tracking outputs from all agent types (research, implementation, validation, documentation) in the Orchestrator Protocol",
  "type": "object",
  "required": [
    "id",
    "file",
    "title",
    "date",
    "status",
    "topics",
    "key_findings",
    "actionable"
  ],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique identifier slug with date suffix",
      "pattern": "^[a-z0-9-]+-[0-9]{4}-[0-9]{2}-[0-9]{2}$"
    },
    "file": {
      "type": "string",
      "description": "Output filename in agent-outputs directory (relative path)",
      "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}_[a-z0-9-]+\\.md$"
    },
    "title": {
      "type": "string",
      "description": "Human-readable title for the agent output entry",
      "minLength": 5,
      "maxLength": 200
    },
    "date": {
      "type": "string",
      "description": "ISO 8601 date (YYYY-MM-DD)",
      "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$"
    },
    "timestamp": {
      "type": "string",
      "description": "ISO 8601 datetime for precise ordering",
      "format": "date-time"
    },
    "status": {
      "type": "string",
      "description": "Progress status of the agent output",
      "enum": ["complete", "partial", "blocked", "archived"]
    },
    "topics": {
      "type": "array",
      "description": "Categorization tags",
      "items": {"type": "string"},
      "minItems": 1,
      "maxItems": 10
    },
    "key_findings": {
      "type": "array",
      "description": "Executive summary (3-7 single-sentence findings)",
      "items": {
        "type": "string",
        "maxLength": 200
      },
      "minItems": 3,
      "maxItems": 7
    },
    "actionable": {
      "type": "boolean",
      "description": "Whether this agent output requires follow-up action"
    },
    "needs_followup": {
      "type": "array",
      "description": "Task IDs or BLOCKED:reason entries for handoff",
      "items": {
        "type": "string",
        "pattern": "^(T[0-9]+|BLOCKED:.+)$"
      },
      "default": []
    },
    "linked_tasks": {
      "type": "array",
      "description": "CLEO task IDs this agent output relates to",
      "items": {
        "type": "string",
        "pattern": "^T[0-9]+$"
      }
    },
    "agent_type": {
      "type": "string",
      "description": "Type of agent that created this output entry",
      "enum": ["research", "implementation", "validation", "documentation", "analysis"],
      "default": "research"
    },
    "source": {
      "type": "string",
      "description": "Origin of the entry (e.g., epic-architect)"
    },
    "output_file": {
      "type": "string",
      "description": "Relative path to output file in agent-outputs directory (alternative to file field)"
    },
    "files_modified": {
      "type": "array",
      "description": "Files modified by implementation agents (relative paths from project root)",
      "items": {
        "type": "string"
      }
    },
    "tests_run": {
      "type": "array",
      "description": "Test results from validation agents",
      "items": {
        "type": "object",
        "properties": {
          "test": {
            "type": "string",
            "description": "Test name or file path"
          },
          "result": {
            "type": "string",
            "enum": ["pass", "fail", "skip", "error"]
          },
          "details": {
            "type": "string",
            "description": "Optional failure details or notes"
          }
        },
        "required": ["test", "result"]
      }
    },
    "documentation_artifacts": {
      "type": "array",
      "description": "Documentation files created or updated by documentation agents",
      "items": {
        "type": "string"
      }
    }
  },
  "additionalProperties": true
}
